<div mat-dialog-title>
  <h1>Cambiar contraseña</h1>
</div>
<form [formGroup]="passwordEditForm" (ngSubmit)="onSubmit()">
  <div mat-dialog-content class="content">
    <div class="row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Contraseña actual</mat-label>
        <input matInput type="password" formControlName="oldPassword" placeholder="Contraseña actual">
        <mat-error *ngIf="oldPassword?.hasError('required') && (oldPassword?.touched || oldPassword?.dirty)">
          La contraseña actual es requerida
        </mat-error>
      </mat-form-field>
    </div>

    <div class="row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Nueva contraseña</mat-label>
        <input matInput type="password" formControlName="newPassword" placeholder="Nueva contraseña">
        <mat-error *ngIf="newPassword?.hasError('required') && (newPassword?.touched || newPassword?.dirty)">
          La nueva contraseña es requerida
        </mat-error>
        <mat-error *ngIf="newPassword?.hasError('minlength') && (newPassword?.touched || newPassword?.dirty)">
          La contraseña debe tener al menos 8 caracteres
        </mat-error>
      </mat-form-field>
    </div>

    <div class="row">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Confirmar nueva contraseña</mat-label>
        <input matInput type="password" formControlName="confirmNewPassword" placeholder="Confirma nueva contraseña">
        <mat-error *ngIf="confirmNewPassword?.hasError('required') && (confirmNewPassword?.touched || confirmNewPassword?.dirty)">
          Confirma la nueva contraseña
        </mat-error>
        <mat-error *ngIf="confirmNewPassword?.hasError('mismatch')">
          Las contraseñas no coinciden
        </mat-error>
      </mat-form-field>
    </div>

  </div>
  <div mat-dialog-actions class="action-btns">
    <button style="margin: 10px; min-width:120px;" mat-raised-button color="basic" type="submit" [disabled]="submitting || passwordEditForm.invalid">
      <span *ngIf="!submitting">Guardar</span>
      <span *ngIf="submitting" style="display:flex; align-items:center; gap:8px;">
        <mat-progress-spinner diameter="18" mode="indeterminate"></mat-progress-spinner>
        Guardando...
      </span>
    </button>
    <button mat-raised-button type="button" color="warn" (click)="onCancel()">Cancelar</button>
  </div>
</form>
